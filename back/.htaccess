# Activation des logs
php_flag log_errors on
php_value error_log "/var/log/apache2/php_errors.log"

# Désactivation de l'affichage des erreurs
php_flag display_errors off
php_value error_reporting E_ALL

# Forcer le type de contenu JSON pour l'API
<FilesMatch "api\.php$">
    ForceType application/json
    Header set Content-Type "application/json"
</FilesMatch>

RewriteEngine On

# Base pour les routes API
RewriteBase /api/

# Redirection de toutes les requêtes API vers api.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ routes/api.php [QSA,L]

# Gestion des erreurs
ErrorDocument 500 "{\"success\":false,\"message\":\"Erreur serveur interne\"}"
ErrorDocument 404 "{\"success\":false,\"message\":\"Route non trouvée\"}"
ErrorDocument 403 "{\"success\":false,\"message\":\"Accès non autorisé\"}"

# Désactivation de l'affichage du contenu des répertoires
Options -Indexes

# Protection des fichiers sensibles
<FilesMatch "^(config\.php|\.htaccess)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Activation des logs détaillés
LogLevel debug rewrite:trace8 