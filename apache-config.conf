<VirtualHost *:727>
    ServerAdmin webmaster@localhost
    ServerName localhost
    DocumentRoot /var/www/azure/Azure-Full-Stack-App

    # Logs détaillés
    LogLevel debug
    ErrorLog ${APACHE_LOG_DIR}/azure-app-error.log
    CustomLog ${APACHE_LOG_DIR}/azure-app-access.log combined

    # Configuration du répertoire racine
    <Directory /var/www/azure/Azure-Full-Stack-App>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
        DirectoryIndex index.php

        # Permissions détaillées
        <IfModule mod_authz_core.c>
            Require all granted
        </IfModule>
        <IfModule !mod_authz_core.c>
            Order Allow,Deny
            Allow from all
        </IfModule>
    </Directory>

    # Configuration du répertoire back
    <Directory /var/www/azure/Azure-Full-Stack-App/back>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted

        # Permissions détaillées
        <IfModule mod_authz_core.c>
            Require all granted
        </IfModule>
        <IfModule !mod_authz_core.c>
            Order Allow,Deny
            Allow from all
        </IfModule>
    </Directory>

    # Configuration du répertoire front
    <Directory /var/www/azure/Azure-Full-Stack-App/front>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted

        # Permissions détaillées
        <IfModule mod_authz_core.c>
            Require all granted
        </IfModule>
        <IfModule !mod_authz_core.c>
            Order Allow,Deny
            Allow from all
        </IfModule>
    </Directory>

    # Configuration PHP
    <FilesMatch \.php$>
        SetHandler application/x-httpd-php
    </FilesMatch>

    # Configuration des permissions
    <IfModule mod_suexec.c>
        SuexecUserGroup user-00 user-00
    </IfModule>

    # Configuration SELinux (si activé)
    <IfModule mod_selinux.c>
        SELinuxContext unconfined_u:unconfined_r:unconfined_t:s0
    </IfModule>
</VirtualHost> 